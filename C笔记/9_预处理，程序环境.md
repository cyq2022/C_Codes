![image-20231103085824101](assets/image-20231103085824101.png)

# 翻译环境



![image-20231103090125876](assets/image-20231103090125876.png)





![image-20231103090826719](assets/image-20231103090826719.png)

![image-20231103090541527](assets/image-20231103090541527.png)

每个源文件经过编译器 生成 .obj 目标文件 （win环境）





链接库： 包含库函数



编译器。cl.exe



# 编译

预处理，预编译

编译

汇编

![image-20231103092427968](assets/image-20231103092427968.png)





## 预处理

文本操作;

1. 把头文件包含



2. define 定义符号的替换  ， 删除定义的符号



3. 删除注释

![image-20231103092212145](assets/image-20231103092212145.png)



## 编译

https://www.bilibili.com/video/BV1Vm4y1r7jY?t=358.4&p=170



![image-20231103094304557](assets/image-20231103094304557.png)



符号汇总

形成符号表

符号表合并重定位

![image-20231103094437256](assets/image-20231103094437256.png)









# 运行环境

![image-20231103095352762](assets/image-20231103095352762.png)





# 预处理详解



内置预定义符号 



![image-20231103095741384](assets/image-20231103095741384.png)



![image-20231103095725962](assets/image-20231103095725962.png)





## define



![image-20231103100538876](assets/image-20231103100538876.png)

续航符号  \





# define定义宏



![image-20231103102415327](assets/image-20231103102415327.png)

宏 完成 替换  

  直接替换 文本而不是先计算

square（5+1）

5  + 1 \* 5  + 1



修改

![image-20231103102535058](assets/image-20231103102535058.png)





错误2 整体需要（）

![image-20231103102814162](assets/image-20231103102814162.png)

![image-20231103103059562](assets/image-20231103103059562.png)

# #和##

![image-20231103104027698](assets/image-20231103104027698.png)

##    参数没有替换进去，把参数转换成字符串

![image-20231103103834083](assets/image-20231103103834083.png)

https://www.bilibili.com/video/BV1Vm4y1r7jY?t=1744.9&p=171









## ##

![image-20231103104349771](assets/image-20231103104349771.png)





![image-20231103104605873](assets/image-20231103104605873.png)



连接两个符号 作为一个符号  



# 宏的副作用

![image-20231103105349844](assets/image-20231103105349844.png)



参数带有副作用





# 宏和函数

​	预处理完完成替换， 宏直接替换代码快 函数要传输和转换

![image-20231103121614599](assets/image-20231103121614599.png)

1. 速度快
2. 类型无关

## 缺点

![image-20231103121801188](assets/image-20231103121801188.png)

程序长度大幅增加；

无法调试 ；

运算符优先级；

不能递归；



## 只有宏可以做的

![image-20231103122053142](assets/image-20231103122053142.png)

参数传类型





![image-20231103122429999](assets/image-20231103122429999.png)





## 命名

宏全大写   

函数不全大写



## #undef

取消定义符号





## 命令行定义

![image-20231103124010585](assets/image-20231103124010585.png)

![image-20231103124057967](assets/image-20231103124057967.png)

编译时 命令行定义







## 条件编译



![image-20231103124423026](assets/image-20231103124423026.png)





#if 常量表达式



![image-20231103124755749](assets/image-20231103124755749.png)



![image-20231103124934586](assets/image-20231103124934586.png)





## 文件包含

头文件包含多次， 拷贝多次





防止多次包含，

1

![image-20231103125813297](assets/image-20231103125813297.png)

2  #pragma once  头文件只能包含一次  

![image-20231103125930189](assets/image-20231103125930189.png)



场景

comm文件被引用2次

![image-20231103130529389](assets/image-20231103130529389.png)

## 头文件<>"" 

![image-20231103130244502](assets/image-20231103130244502.png)









# 例题

![image-20231103132647647](assets/image-20231103132647647.png)

![image-20231103132656067](assets/image-20231103132656067.png)